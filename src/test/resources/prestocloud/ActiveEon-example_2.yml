tosca_definitions_version: tosca_prestocloud_mapping_1_2

metadata:
   template_name: ICCS generated types definition
   template_author: ICCS
   template_version: 1.0.0-SNAPSHOT
   CostThreshold: 1000.0
   TimePeriod:  720
   ProviderName_0: Google_Cloud_Compute
   ProviderRequired_0: false
   ProviderExcluded_0: true
   MaxInstances: 100
   MetricToMinimize: Cost

description: Types Description

imports:
   - tosca-normative-types:1.2
   - iccs-normative-types:1.0
   - resource-descriptions:1.0
   - placement-constraints:1.0

topology_template:
  node_templates:

    #Concrete node selection:
    processing_node_fragments_AudioCaptor_1:
      type: prestocloud.nodes.compute.edge
      properties:
        type: edge
      capabilities:
        resource:
          properties:
            type: edge
            edge:
              edge_type: raspberry
              edge_location: paris
              edge_credentials:
                username: admin
                password: admin
              edge_network:
                network_id: netid1
                network_name: local-net
                addresses:
                  - 10.0.0.1
        host:
          properties:
            num_cpus: 1
            mem_size: 2.0 GB
            disk_size: 30 GB

    processing_node_fragments_FaceDetector_1:
      type: prestocloud.nodes.compute.cloud.amazon
      properties:
        type: cloud
      capabilities:
        resource:
          properties:
            type: cloud
            cloud:
              cloud_name: amazon_public1
              cloud_type: amazon
              cloud_region: us-east-1
              cloud_network:
                network_id: s-gbdpnc4s
                network_name: subnet1
                addresses:
                  - 192.168.1.1
        host:
          properties:
            num_cpus: 2
            mem_size: 4.0 GB
            disk_size: 50 GB
            price: 0.120000

    processing_node_fragments_MultimediaManager_1:
      type: prestocloud.nodes.compute.cloud.amazon
      properties:
        type: cloud
      capabilities:
        resource:
          properties:
            type: cloud
            cloud:
              cloud_name: amazon_public1
              cloud_type: amazon
              cloud_region: us-east-1
              cloud_network:
                network_id: s-gbdpnc4s
                network_name: subnet1
                addresses:
                  - 192.168.1.2
        host:
          properties:
            num_cpus: 2
            mem_size: 4.0 GB
            disk_size: 100 GB
            price: 0.150000

    processing_node_fragments_VideoTranscoder_1:
      type: prestocloud.nodes.compute.cloud.amazon
      properties:
        type: cloud
      capabilities:
        resource:
          properties:
            type: cloud
            cloud:
              cloud_name: amazon_public1
              cloud_type: amazon
              cloud_region: us-east-1
              cloud_network:
                network_id: s-gbdpnc4s
                network_name: subnet1
                addresses:
                  - 192.168.1.3
        host:
          properties:
            num_cpus: 2
            mem_size: 4.0 GB
            disk_size: 50 GB
            price: 0.120000

    processing_node_fragments_PercussionDetector_1:
      type: prestocloud.nodes.compute.edge
      properties:
        type: edge
      capabilities:
        resource:
          properties:
            type: edge
            edge:
              edge_type: raspberry
              edge_location: paris
              edge_credentials:
                username: admin
                password: admin
              edge_network:
                network_id: netid1
                network_name: local-net
                addresses:
                  - 10.0.0.2
        host:
          properties:
            num_cpus: 1
            mem_size: 2.0 GB
            disk_size: 30 GB

    processing_node_fragments_VideoStreamer_1:
      type: prestocloud.nodes.compute.edge
      properties:
        type: edge
      capabilities:
        resource:
          properties:
            type: edge
            edge:
              edge_type: raspberry
              edge_location: paris
              edge_credentials:
                username: admin
                password: admin
              edge_network:
                network_id: netid1
                network_name: local-net
                addresses:
                  - 10.0.0.3
        host:
          properties:
            num_cpus: 1
            mem_size: 2.0 GB
            disk_size: 30 GB

    processing_node_fragments_VideoStreamer_2:
      type: prestocloud.nodes.compute.edge
      properties:
        type: edge
      capabilities:
        resource:
          properties:
            type: edge
            edge:
              edge_type: raspberry
              edge_location: paris
              edge_credentials:
                username: admin
                password: admin
              edge_network:
                network_id: netid1
                network_name: local-net
                addresses:
                  - 10.0.0.4
        host:
          properties:
            num_cpus: 1
            mem_size: 2.0 GB
            disk_size: 30 GB

    processing_node_fragments_VideoStreamer_3:
      type: prestocloud.nodes.compute.edge
      properties:
        type: edge
      capabilities:
        resource:
          properties:
            type: edge
            edge:
              edge_type: raspberry
              edge_location: paris
              edge_credentials:
                username: admin
                password: admin
              edge_network:
                network_id: netid1
                network_name: local-net
                addresses:
                  - 10.0.0.5
        host:
          properties:
            num_cpus: 1
            mem_size: 2.0 GB
            disk_size: 30 GB

    deployment_node_fragments_AudioCaptor_1:
      type: prestocloud.nodes.agent.faas
      requirements:
        - host: processing_node_fragments_AudioCaptor_1

    fragments_AudioCaptor_1:
      type: prestocloud.nodes.fragment.faas
      properties:
        id: 0
        name: fragments.AudioCaptor
        onloadable: true
      requirements:
        - execute: deployment_node_fragments_AudioCaptor_1

    deployment_node_fragments_FaceDetector_1:
      type: prestocloud.nodes.agent.faas
      requirements:
        - host: processing_node_fragments_FaceDetector_1

    fragments_FaceDetector_1:
      type: prestocloud.nodes.fragment.faas
      properties:
        id: 1
        name: fragments.FaceDetector
        onloadable: false
      requirements:
        - execute: deployment_node_fragments_FaceDetector_1

    deployment_node_fragments_MultimediaManager_1:
      type: prestocloud.nodes.agent.faas
      requirements:
        - host: processing_node_fragments_MultimediaManager_1

    fragments_MultimediaManager_1:
      type: prestocloud.nodes.fragment.faas
      properties:
        id: 2
        name: fragments.MultimediaManager
        onloadable: false
      requirements:
        - execute: deployment_node_fragments_MultimediaManager_1

    deployment_node_fragments_VideoTranscoder_1:
      type: prestocloud.nodes.agent.faas
      requirements:
        - host: processing_node_fragments_VideoTranscoder_1

    fragments_VideoTranscoder_1:
      type: prestocloud.nodes.fragment.faas
      properties:
        id: 3
        name: fragments.VideoTranscoder
        onloadable: false
      requirements:
        - execute: deployment_node_fragments_VideoTranscoder_1

    deployment_node_fragments_PercussionDetector_1:
      type: prestocloud.nodes.agent.faas
      requirements:
        - host: processing_node_fragments_PercussionDetector_1

    fragments_PercussionDetector_1:
      type: prestocloud.nodes.fragment.faas
      properties:
        id: 4
        name: fragments.PercussionDetector
        onloadable: true
      requirements:
        - execute: deployment_node_fragments_PercussionDetector_1

    deployment_node_fragments_VideoStreamer_1:
      type: prestocloud.nodes.agent.faas
      requirements:
        - host: processing_node_fragments_VideoStreamer_1

    fragments_VideoStreamer_1:
      type: prestocloud.nodes.fragment.faas
      properties:
        id: 5
        name: fragments.VideoStreamer
        onloadable: true
      requirements:
        - execute: deployment_node_fragments_VideoStreamer_1

    deployment_node_fragments_VideoStreamer_2:
      type: prestocloud.nodes.agent.faas
      requirements:
        - host: processing_node_fragments_VideoStreamer_2

    fragments_VideoStreamer_2:
      type: prestocloud.nodes.fragment.faas
      properties:
        id: 5
        name: fragments.VideoStreamer
        onloadable: true
      requirements:
        - execute: deployment_node_fragments_VideoStreamer_2

    deployment_node_fragments_VideoStreamer_3:
      type: prestocloud.nodes.agent.faas
      requirements:
        - host: processing_node_fragments_VideoStreamer_3

    fragments_VideoStreamer_3:
      type: prestocloud.nodes.fragment.faas
      properties:
        id: 5
        name: fragments.VideoStreamer
        onloadable: true
      requirements:
        - execute: deployment_node_fragments_VideoStreamer_3
