tosca_definitions_version: tosca_prestocloud_mapping_1_2

metadata:
  template_name: ICCS_normative_types
  template_author: ICCS
  template_version: 1.0

description: ICCS normative types definition.

imports:
  - tosca-normative-types:1.2
  - resource-descriptions:1.0

node_types:

  prestocloud.nodes.fragment:
   description: A TOSCA description of an application fragment
   derived_from: tosca.nodes.Root
   properties:
     id:
       type: integer
       required: true
     name:
       type: string
       required: false
     onloadable:
       type: boolean
       required: false
   requirements:
     - execute:
        node: prestocloud.nodes.jppf.Agent
        capability: prestocloud.capabilities.jppf.fragmentExecution
        relationship: prestocloud.relationships.jppf.ExecutedBy

  prestocloud.nodes.jppf.Agent:
    description: A basic JPPF-agent node
    derived_from: tosca.nodes.Root
    capabilities:
      fragments:
        type: prestocloud.capabilities.jppf.fragmentExecution
    properties:
      component_version:
        type: version
        required: false
    requirements:
      - host:
         node: prestocloud.nodes.compute
         capability: tosca.capabilities.Container
         relationship: tosca.relationships.HostedOn
      - master:
         capability: prestocloud.capabilities.jppf.endpoint
         node: prestocloud.nodes.jppf.Master
         relationship: prestocloud.relationships.jppf.ConnectsTo

  prestocloud.nodes.jppf.Master:
    description: A basic JPPF-master node
    derived_from: tosca.nodes.Root
    capabilities:
      jppf_endpoint:
        type: prestocloud.capabilities.jppf.endpoint
    properties:
      component_version:
        type: version
        required: false
    requirements:
      - host:
         node: prestocloud.nodes.compute
         capability: tosca.capabilities.Container
         relationship: tosca.relationships.HostedOn

capability_types:

  prestocloud.capabilities.jppf.endpoint:
    description: Provide JPPF master endpoint
    derived_from: tosca.capabilities.Root
    properties:
      protocol:
        type: string
        required: true
        default: tcp
      port:
        type: tosca.datatypes.network.PortDef
        required: false
      secure:
        type: boolean
        required: false
        default: false
      ip_address:
        type: string
        required: false
    valid_source_types: [ prestocloud.nodes.jppf.Agent ]

  prestocloud.capabilities.jppf.fragmentExecution:
    description: Capability to execute a fragment
    derived_from: tosca.capabilities.Root
    properties:
    valid_source_types: [ prestocloud.nodes.fragment ]


relationship_types:

  prestocloud.relationships.jppf.ConnectsTo:
    derived_from: tosca.relationships.Root
    valid_target_types: [ prestocloud.nodes.jppf.endpoint ]
    properties:
      credential:
        type: tosca.datatypes.Credential
        required: false

  prestocloud.relationships.jppf.ExecutedBy:
    derived_from: tosca.relationships.Root
    valid_target_types: [ prestocloud.capabilities.jppf.fragmentExecution ]
